<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zoho Sweet-Spot Generator</title>
    <style>
        body { font-family: sans-serif; max-width: 800px; margin: 40px auto; padding: 20px; line-height: 1.6; background: #f4f7f6; }
        h2 { color: #00ca96; }
        textarea { width: 100%; height: 180px; border: 2px solid #ddd; border-radius: 8px; padding: 10px; font-family: monospace; }
        button { background: #00ca96; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; font-size: 16px; margin-top: 10px; font-weight: bold; }
        button:hover { background: #00a87d; }
        .output-container { margin-top: 30px; display: none; }
        #finalCode { background: #2d3436; color: #fab1a0; padding: 15px; border-radius: 8px; overflow-x: auto; white-space: pre-wrap; word-break: break-all; }
        .copy-btn { background: #0984e3; margin-top: 10px; }
    </style>
</head>
<body>

    <h2>Zoho Sweet-Spot Transformer</h2>
    <p>Paste your original Zoho embed code below to get the version with the fixed scrollbar, right-leaning center, and -20px top margin.</p>
    
    <textarea id="rawInput" placeholder="Paste Zoho <div data-embed-id=...> code here..."></textarea>
    <br>
    <button onclick="transformCode()">Generate Sweet-Spot Code</button>

    <div id="outputArea" class="output-container">
        <h3>Your Optimized Code:</h3>
        <div id="finalCode"></div>
        <button class="copy-btn" onclick="copyToClipboard()">Copy to Clipboard</button>
    </div>

    <script>
        function transformCode() {
            const input = document.getElementById('rawInput').value;
            
            // Extract the data-embed-id using regex
            const embedIdMatch = input.match(/data-embed-id="([^"]+)"/);
            
            if (!embedIdMatch) {
                alert("Could not find a valid data-embed-id. Please check your Zoho code.");
                return;
            }

            const embedId = embedIdMatch[1];
            
            // This is the "Sweet Spot" template we built
            const result = `<div style="display: flex; justify-content: center; padding-left: 15%; width: 100%; margin: -20px 0 20px 0;">
    <div style="width: auto; height: 85px; overflow: hidden; display: block; line-height: 0;">
        ${input}
    </div>
</div>`;

            document.getElementById('finalCode').innerText = result;
            document.getElementById('outputArea').style.display = 'block';
        }

        function copyToClipboard() {
            const text = document.getElementById('finalCode').innerText;
            navigator.clipboard.writeText(text).then(() => {
                alert("Code copied to clipboard!");
            });
        }
    </script>

</body>
</html>
